function soo_save_location(a,e){a=parseInt(a,10),1!=e&&(saved_location.zoom=map.getZoom(),saved_location.center=new Array,saved_location.center.lat=map.getCenter().lat(),saved_location.center.lng=map.getCenter().lng(),saved_location[a]=new Array,saved_location[a].lat=marker_latlng.lat(),saved_location[a].lng=marker_latlng.lng())}function map_point(a){center=result_array[a].geometry.location,map.setCenter(center),latlng=center,marker.setMap(null),marker_latlng=result_array[a].geometry.location,marker=new google.maps.Marker({position:marker_latlng,map:map,draggable:!0}),soo_marker_event(),marker.setMap(map),infowindow.close(),infowindow=new google.maps.InfoWindow({content:dragmarkertext+"<br /><strong>"+result_array[a].formatted_address+"</strong>",disableAutoPan:!0}),infowindow.open(map,marker)}function view_list(){var a="";if(0==result_array.length)return void alert(no_result);for(var e=0;e<result_array.length;e++){0==e&&(a+='<ul id="view_list">'),1==result_array.length&&map_point("0");var o=result_array[e].formatted_address.split(" "),t=result_array[e].formatted_address.substring(result_array[e].formatted_address.lastIndexOf(o[o.length-3]));a+='<li class="result_lists"><a href="javascript:map_point(\''+e+"');\">"+t+"</a></li>"}a+="</ul>",jQuery("#result_list_layer").html(a),window.location.href="#view_list"}function addAddressToMap(a,e){200==e?result_from="naver":e==google.maps.GeocoderStatus.OK&&(result_from="google"),e!=google.maps.GeocoderStatus.OK&&200!=e?alert(no_result+"\nGoogle Error Code : "+e):(result_array=new Array,result_array=a,view_list())}function showLocation(a){if(result_from="",a){var e=new Array;e.component="map_components",e.address=a,e.method="search";var o=new Array("error","message","results");exec_xml("editor","procEditorCall",e,function(e,o){complete_search(e,o,a)},o)}}function complete_search(a){var e=a.results;e=e?e.item:new Array,address_adder(e)}function address_adder(a){var e=new Array;"undefined"==typeof a.length&&(a=new Array(a));for(var o=0;o<a.length;o++)(a[o].formatted_address||null!=a[o].formatted_address)&&(e[o]={from:a[o].result_from,formatted_address:a[o].formatted_address,geometry:{location:new google.maps.LatLng(a[o].geometry.lat,a[o].geometry.lng)}});addAddressToMap(e,200)}function soo_marker_event(){google.maps.event.addListener(marker,"dragstart",function(){infowindow.close()}),google.maps.event.addListener(marker,"dragend",function(a){a.latLng&&(geocoder.geocode({latLng:a.latLng},function(a,e){e==google.maps.GeocoderStatus.OK&&(a[1]?(infowindow.close(),infowindow=new google.maps.InfoWindow({content:dragmarkertext+"<br />"+a[1].formatted_address}),infowindow.open(map,marker)):(infowindow.close(),infowindow=new google.maps.InfoWindow({content:dragmarkertext}),infowindow.open(map,marker)))}),marker_latlng=a.latLng)})}function getMaps(){var a={zoom:8,mapTypeId:google.maps.MapTypeId.ROADMAP};if(map=new google.maps.Map(document.getElementById("map_canvas"),a),infowindow=new google.maps.InfoWindow,"undefined"!=typeof opener&&null!=opener)var e=opener.editorPrevNode;if("undefined"!=typeof e&&e&&"IMG"==e.nodeName){saved_location.zoom=e.getAttribute("map_zoom"),saved_location.center=new Array;var o=e.getAttribute("map_center").split(",");if(saved_location.center.lat=o[0],saved_location.center.lng=o[1],e.getAttribute("location_no")){var t=parseInt(e.getAttribute("location_no"),10),r=e.getAttribute("map_markers").split(";");for(i=0;t>i;i++)if(r[i]){var n=r[i].split(",");saved_location[i]=new Array,saved_location[i].lat=n[0],saved_location[i].lng=n[1]}map_lat=saved_location.center.lat,map_lng=saved_location.center.lng,marker_lat=saved_location[0].lat,marker_lng=saved_location[0].lng,marker_latlng=new google.maps.LatLng(marker_lat,marker_lng),latlng=marker_latlng,map_zoom=parseInt(saved_location.zoom,10),marker_latlng&&(latlng=marker_latlng),map_zoom&&jQuery("#map_zoom").val(map_zoom),map_lat&&jQuery("#lat").val(map_lat),map_lng&&jQuery("#lng").val(map_lng)}else{var n=e.getAttribute("map_markers").split(",");saved_location[0]=new Array,saved_location[0].lat=n[0],saved_location[0].lng=n[1],map_lat=saved_location.center.lat,map_lng=saved_location.center.lng,marker_lat=saved_location[0].lat,marker_lng=saved_location[0].lng,marker_latlng=new google.maps.LatLng(marker_lat,marker_lng),latlng=marker_latlng,map_zoom=parseInt(e.getAttribute("map_zoom"),10),marker_latlng&&(latlng=marker_latlng),map_zoom&&jQuery("#map_zoom").val(map_zoom),map_lat&&jQuery("#lat").val(map_lat),map_lng&&jQuery("#lng").val(map_lng)}map.setCenter(new google.maps.LatLng(map_lat,map_lng)),map.setZoom(map_zoom);var l=map.getCenter()}else{jQuery("#lat").val(defaultlat),map_lat=defaultlat,jQuery("#lng").val(defaultlng),map_lng=defaultlng,map.setCenter(new google.maps.LatLng(map_lat,map_lng));var l=map.getCenter();marker_latlng=l,jQuery("#width").val("600"),jQuery("#height").val("400"),latlng=l}map.setZoom(map_zoom),google.maps.event.addListener(map,"dragend",function(){l=map.getCenter(),jQuery("#lng").val(l.lng()),jQuery("#lat").val(l.lat()),jQuery("#map_zoom").val(map.getZoom());var a=map.getBounds(),e=a.getSouthWest(),o=a.getNorthEast();(latlng.lng()<e.lng()||o.lng()<latlng.lng()||latlng.lat()<e.lat()||o.lat()<latlng.lat())&&(marker.setMap(null),infowindow.close(),latlng=l,marker_latlng=latlng,marker=new google.maps.Marker({position:l,map:map,draggable:!0}),marker.setMap(map),infowindow=new google.maps.InfoWindow({content:dragmarkertext,disableAutoPan:!0}),infowindow.open(map,marker),soo_marker_event())}),marker=new google.maps.Marker({position:latlng,map:map,draggable:!0}),soo_marker_event(),marker.setMap(map),geocoder=new google.maps.Geocoder,jQuery("#lng").val(l.lng()),jQuery("#lat").val(l.lat()),jQuery("#map_zoom").value=map.getZoom(),marker_latlng=latlng,infowindow.close()}function insertMap(){if("undefined"!=typeof opener&&opener){var a=jQuery("#width").val(),e=jQuery("#height").val();if(0==saved_location.length||1==saved_location.length){map_zoom=map.getZoom(),map_lat=map.getCenter().lat(),map_lng=map.getCenter().lng(),a||(a="600"),e||(e="400"),map_zoom||(map_zoom="13");var o='<img src="https://maps-api-ssl.google.com/maps/api/staticmap?center='+map_lat+","+map_lng+"&zoom="+map_zoom+"&size="+a+"x"+e+"&markers=size:mid|"+marker_latlng.lat()+","+marker_latlng.lng()+'&sensor=false" editor_component="map_components" map_center="'+map_lat+","+map_lng+'" map_markers="'+marker_latlng.lat()+","+marker_latlng.lng()+'" map_zoom="'+map_zoom+'" style="border:2px dotted #FF0033; no-repeat center;width: '+a+"px; height: "+e+'px;" />'}else{var o='<img src="https://maps-api-ssl.google.com/maps/api/staticmap?center='+saved_location[0][1]+","+saved_location[0][2]+"&zoom="+saved_location[0][0]+"&size="+a+"x"+e+'&sensor=false" editor_component="map_components" width="'+a+'" height="'+e+'" style="width:'+a+"px;height:"+e+'px;border:2px dotted #FF0033;"';o+=' location_no="'+saved_location.length+'"',o+=' map_zoom="'+saved_location.zoom+'"',o+=' map_center="'+saved_location.center.lat+","+saved_location.center.lng,o+=' map_markers="';for(var t=0;t<saved_location.length;t++)o+=saved_location[t][3]+","+saved_location[t][4]+";";o+='" />'}opener.editorFocus(opener.editorPrevSrl);var r=opener.editorGetIFrame(opener.editorPrevSrl);opener.editorReplaceHTML(r,o),opener.editorFocus(opener.editorPrevSrl),window.close()}}var map_zoom=13,map_lat="",map_lng="",marker_latlng="",map="",marker="",saved_location=new Array,result_array=new Array,infowindow="",result_from="";jQuery(document).ready(function(){getMaps()});