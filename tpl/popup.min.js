function soo_save_location(e,a){e=parseInt(e,10),1!=a&&(saved_location[e]=new Array,saved_location[e][0]=map.getZoom(),saved_location[e][1]=map.getCenter().lat(),saved_location[e][2]=map.getCenter().lng(),saved_location[e][3]=marker_latlng.lat(),saved_location[e][4]=marker_latlng.lng());var o='<form action="#" onsubmit="soo_save_location(this.locations.value); return false" id="form_to_save"><select size="1" id="locations">',t=0;for(t=0;t<saved_location.length;t++)o+=t==e?'<option value="'+t+'" selected="selected">'+(t+1)+"["+soo_editing+"]</option>":'<option value="'+t+'">'+(t+1)+"</option>";o+='<option value="'+t+'">'+(t+1)+"</option>",o+='</select><br /><span class="button red"><input id="save_btn" type="submit" value="'+soo_save+'" /></span> <span class="button"><button type="button" onclick="soo_load_location();">'+soo_edit+"</button></span></form>",jQuery("#save_form").html(o)}function soo_load_location(){var e=document.getElementById("form_to_save"),a=e.locations.selectedIndex;return a=parseInt(a,10),saved_location[a]?(jQuery("#map_zoom").val(saved_location[a][0]),jQuery("#lat").val(saved_location[a][1]),jQuery("#lng").val(saved_location[a][2]),map_zoom=parseInt(jQuery("#map_zoom").val(),10),center=new google.maps.LatLng(saved_location[a][1],saved_location[a][2]),map.setCenter(center),map.setZoom(map_zoom),marker.setMap(null),marker_latlng=new google.maps.LatLng(saved_location[a][3],saved_location[a][4]),marker=new google.maps.Marker({position:marker_latlng,map:map,draggable:!0}),soo_marker_event(),marker.setMap(map),infowindow.close(),infowindow=new google.maps.InfoWindow({content:dragmarkertext+"<br /><strong>"+saved_location[a][5]+"</strong>",disableAutoPan:!0}),infowindow.open(map,marker),void soo_save_location(a,1)):void alert(soo_nulledit)}function map_point(e){map_zoom=parseInt(jQuery("#map_zoom").val(),10),center=result_array[e].geometry.location,map.setCenter(center),latlng=center,marker.setMap(null),marker_latlng=result_array[e].geometry.location,marker=new google.maps.Marker({position:marker_latlng,map:map,draggable:!0}),soo_marker_event(),marker.setMap(map),infowindow.close(),infowindow=new google.maps.InfoWindow({content:dragmarkertext+"<br /><strong>"+result_array[e].formatted_address+"</strong>",disableAutoPan:!0}),infowindow.open(map,marker)}function view_list(){var e="";if(0==result_array.length)return void alert(no_result);for(var a=0;a<result_array.length;a++)0==a&&(e+='<ul id="view_list">'),1==result_array.length&&map_point("0"),e+='<li class="result_lists"><a href="javascript:map_point(\''+a+"');\">"+result_array[a].formatted_address+"</a></li>";e+="</ul>",jQuery("#result_list_layer").html(e),window.location.href="#view_list"}function addAddressToMap(e,a){200==a?result_from="naver":a==google.maps.GeocoderStatus.OK&&(result_from="google"),a!=google.maps.GeocoderStatus.OK&&200!=a?alert(no_result+"\nGoogle Error Code : "+a):(result_array=new Array,result_array=e,view_list())}function showLocation(e){if(result_from="",e){var a=new Array;a.component="map_components",a.address=e,a.method="search";var o=new Array("error","message","results");exec_xml("editor","procEditorCall",a,function(a,o){complete_search(a,o,e)},o)}}function complete_search(e){var a=e.results;a=a?a.item:new Array,address_adder(a)}function address_adder(e){var a=new Array;"undefined"==typeof e.length&&(e=new Array(e));for(var o=0;o<e.length;o++)(e[o].formatted_address||null!=e[o].formatted_address)&&(a[o]={from:e[o].result_from,formatted_address:e[o].formatted_address,geometry:{location:new google.maps.LatLng(e[o].geometry.lat,e[o].geometry.lng)}});addAddressToMap(a,200)}function soo_marker_event(){google.maps.event.addListener(marker,"dragstart",function(){infowindow.close()}),google.maps.event.addListener(marker,"dragend",function(e){e.latLng&&(geocoder.geocode({latLng:e.latLng},function(e,a){a==google.maps.GeocoderStatus.OK&&(e[1]?(infowindow.close(),infowindow=new google.maps.InfoWindow({content:dragmarkertext+"<br />"+e[1].formatted_address}),infowindow.open(map,marker)):(infowindow.close(),infowindow=new google.maps.InfoWindow({content:dragmarkertext}),infowindow.open(map,marker)))}),marker_latlng=e.latLng)})}function getGoogleMap(){var e={zoom:8,mapTypeId:google.maps.MapTypeId.ROADMAP};if(map=new google.maps.Map(document.getElementById("map_canvas"),e),"undefined"!=typeof opener){var a=opener.editorPrevNode;if(infowindow=new google.maps.InfoWindow,a&&"IMG"==a.nodeName){if(jQuery("#width").val(jQuery(a).width()),jQuery("#height").val(jQuery(a).height()),a.getAttribute("location_no")){var o=parseInt(a.getAttribute("location_no"),10),t='<form action="#" onsubmit="soo_save_location(this.locations.value); return false" id="form_to_save"><select size="1" id="locations">',n=0;for(n=0;o>n;n++)saved_location[n]=new Array,saved_location[n][0]=a.getAttribute("map_zoom"+n),saved_location[n][1]=a.getAttribute("map_lat"+n),saved_location[n][2]=a.getAttribute("map_lng"+n),saved_location[n][3]=a.getAttribute("marker_lat"+n),saved_location[n][4]=a.getAttribute("marker_lng"+n),t+=0==n?'<option value="'+n+'" selected="selected">'+(n+1)+"["+soo_editing+"]</option>":'<option value="'+n+'">'+(n+1)+"</option>";t+='<option value="'+n+'">'+(n+1)+"</option>",t+='</select><br /><span class="button red"><input id="save_btn" type="submit" value="'+soo_save+'" /></span> <span class="button"><button type="button" onclick="soo_load_location();">'+soo_edit+"</button></span></form>",jQuery("#save_form").html(t),map_lat=saved_location[0][1],map_lng=saved_location[0][2],marker_lat=saved_location[0][3],marker_lng=saved_location[0][4],marker_latlng=new google.maps.LatLng(marker_lat,marker_lng),latlng=marker_latlng,map_zoom=parseInt(saved_location[0][0],10),marker_latlng&&(latlng=marker_latlng),map_zoom&&jQuery("#map_zoom").val(map_zoom),map_lat&&jQuery("#lat").val(map_lat),map_lng&&jQuery("#lng").val(map_lng)}else map_lat=a.getAttribute("map_lat"),map_lng=a.getAttribute("map_lng"),marker_lat=a.getAttribute("marker_lat"),marker_lng=a.getAttribute("marker_lng"),marker_latlng=new google.maps.LatLng(marker_lat,marker_lng),latlng=marker_latlng,map_zoom=parseInt(a.getAttribute("map_zoom"),10),marker_latlng&&(latlng=marker_latlng),map_zoom&&jQuery("#map_zoom").val(map_zoom),map_lat&&jQuery("#lat").val(map_lat),map_lng&&jQuery("#lng").val(map_lng);map.setCenter(new google.maps.LatLng(map_lat,map_lng)),map.setZoom(map_zoom);var r=map.getCenter()}else{jQuery("#lat").val(defaultlat),map_lat=defaultlat,jQuery("#lng").val(defaultlng),map_lng=defaultlng,map.setCenter(new google.maps.LatLng(map_lat,map_lng));var r=map.getCenter();marker_latlng=r,jQuery("#width").val("600"),jQuery("#height").val("400"),latlng=r}soo_map_set(),map.setZoom(map_zoom),google.maps.event.addListener(map,"dragend",function(){r=map.getCenter(),jQuery("#lng").val(r.lng()),jQuery("#lat").val(r.lat()),jQuery("#map_zoom").val(map.getZoom());var e=map.getBounds(),a=e.getSouthWest(),o=e.getNorthEast();(latlng.lng()<a.lng()||o.lng()<latlng.lng()||latlng.lat()<a.lat()||o.lat()<latlng.lat())&&(marker.setMap(null),infowindow.close(),latlng=r,marker_latlng=latlng,marker=new google.maps.Marker({position:r,map:map,draggable:!0}),marker.setMap(map),infowindow=new google.maps.InfoWindow({content:dragmarkertext,disableAutoPan:!0}),infowindow.open(map,marker),soo_marker_event())}),marker=new google.maps.Marker({position:latlng,map:map,draggable:!0}),soo_marker_event(),marker.setMap(map),geocoder=new google.maps.Geocoder,jQuery("#lng").val(r.lng()),jQuery("#lat").val(r.lat()),jQuery("#map_zoom").value=map.getZoom(),marker_latlng=latlng,infowindow.close(),windowResize()}}function windowResize(){var e=document.getElementById("#bodyDiv").offsetWidth,a=document.getElementById("#bodyDiv").offsetHeight;window.resizeTo(e,a)}function insertMap(){if("undefined"!=typeof opener){var e=jQuery("#width").val(),a=jQuery("#height").val();if(0==saved_location.length||1==saved_location.length){if(map_zoom=map.getZoom(),map_lat=map.getCenter().lat(),map_lng=map.getCenter().lng(),e||(e="600"),a||(a="400"),map_zoom||(map_zoom="13"),insert_lat||insert_lng){if(insert_lat&&"undefined"!=typeof opener.document.getElementsByName(insert_lat)[0]){var o=opener.document.getElementsByName(insert_lat)[0].value;"string"==typeof o&&(opener.document.getElementsByName(insert_lat)[0].value=map_lat)}if(insert_lng&&"undefined"!=typeof opener.document.getElementsByName(insert_lng)[0]){var o=opener.document.getElementsByName(insert_lng)[0].value;"string"==typeof o&&(opener.document.getElementsByName(insert_lng)[0].value=map_lng)}}var t='<img src="https://maps-api-ssl.google.com/maps/api/staticmap?center='+map_lat+","+map_lng+"&zoom="+map_zoom+"&size="+e+"x"+a+"&markers=size:mid|"+marker_latlng.lat()+","+marker_latlng.lng()+'&sensor=false" editor_component="map_components" ment="'+ment+'" map_lat="'+map_lat+'" map_lng="'+map_lng+'" marker_lng="'+marker_latlng.lng()+'" marker_lat="'+marker_latlng.lat()+'" map_zoom="'+map_zoom+'" width="'+e+'" height="'+a+'" style="width:'+e+"px;height:"+a+"px;border:2px dotted #FF0033;background:url('https://maps-api-ssl.google.com/maps/api/staticmap?language="+soo_langcode+"&amp;center="+map_lat+","+map_lng+"&amp;zoom="+map_zoom+"&amp;size="+e+"x"+a+"&amp;markers=size:mid|"+marker_latlng.lat()+","+marker_latlng.lng()+"&amp;sensor=false') no-repeat center;\" />"}else{var t='<img src="https://maps-api-ssl.google.com/maps/api/staticmap?center='+saved_location[0][1]+","+saved_location[0][2]+"&zoom="+saved_location[0][0]+"&size="+e+"x"+a+'&sensor=false" editor_component="map_components" width="'+e+'" height="'+a+'" style="width:'+e+"px;height:"+a+'px;border:2px dotted #FF0033;"';t+=' location_no="'+saved_location.length+'"';for(var n=0;n<saved_location.length;n++)t+=" map_zoom"+n+'="'+saved_location[n][0]+'"',t+=" map_lat"+n+'="'+saved_location[n][1]+'"',t+=" map_lng"+n+'="'+saved_location[n][2]+'"',t+=" marker_lat"+n+'="'+saved_location[n][3]+'"',t+=" marker_lng"+n+'="'+saved_location[n][4]+'"',saved_location[n][5]=saved_location[n][5].replace(/</g,"[[STS[["),saved_location[n][5]=saved_location[n][5].replace(/>/g,"]]STS]]"),saved_location[n][5]=saved_location[n][5].replace(/=/g,"[[STS_EQ]]"),t+=" ment"+n+'="'+saved_location[n][5]+'"';t+=" />"}opener.editorFocus(opener.editorPrevSrl);var r=opener.editorGetIFrame(opener.editorPrevSrl);opener.editorReplaceHTML(r,t),opener.editorFocus(opener.editorPrevSrl),window.close()}}var map_zoom=13,map_lat="",map_lng="",marker_latlng="",map="",marker="",saved_location=new Array,result_array=new Array,infowindow="",result_from="";jQuery(document).ready(function(){getGoogleMap()});