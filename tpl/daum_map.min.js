function map_point(a){center=result_array[a].geometry.location,map.setCenter(center)}function view_list(){var a="";if(0==result_array.length)return void alert(no_result);for(var b=0;b<result_array.length;b++){0==b&&(a+='<ul id="view_list">'),1==result_array.length&&map_point("0");var c=result_array[b].formatted_address.split(" "),d=result_array[b].formatted_address.substring(result_array[b].formatted_address.lastIndexOf(c[c.length-3]));a+='<li class="result_lists"><a href="javascript:map_point(\''+b+"');\">"+d+"</a></li>"}a+="</ul>",jQuery("#result_list_layer").html(a),window.location.href="#view_list"}function showLocation(a){if(result_from="",a){var b=new Array;b.component="map_components",b.address=a,b.method="search";var c=new Array("error","message","results");exec_xml("editor","procEditorCall",b,function(b,c){complete_search(b,c,a)},c)}}function complete_search(a){var b=a.results;b=b?b.item:new Array,address_adder(b)}function address_adder(a){result_array=new Array,"undefined"==typeof a.length&&(a=new Array(a));for(var b=0;b<a.length;b++)(a[b].formatted_address||null!=a[b].formatted_address)&&(result_array[b]={from:a[b].result_from,formatted_address:a[b].formatted_address,geometry:{location:new daum.maps.LatLng(a[b].geometry.lat,a[b].geometry.lng)}});view_list()}function getMaps(){var a={level:map_zoom,center:new daum.maps.LatLng(defaultlat,defaultlng)};if(map=new daum.maps.Map(document.getElementById("map_canvas"),a),"undefined"!=typeof opener&&null!=opener)var b=opener.editorPrevNode;if("undefined"!=typeof b&&b&&"IMG"==b.nodeName){var c={component:"map_components",method:"decode_data",style:b.getAttribute("style"),data:b.getAttribute("alt")},d=new Array,e=new Array("error","message","width","height","results");exec_xml("editor","procEditorCall",c,function(a){jQuery("#width").val(parseInt(a.width,10)),jQuery("#height").val(parseInt(a.height,10)),d=a.results;var b=d.map_center.split(",");f=new daum.maps.LatLng(b[0],b[1]),map.setCenter(f),map_lat=f.getLng(),map_lng=f.getLat();d.map_markers.split(";");map_marker_positions=d.map_markers.trim(),marker=addMarker(0),map_zoom=20-parseInt(d.map_zoom,10),map_zoom||(map_zoom=5),map.setLevel(map_zoom)},e)}else{f=new daum.maps.LatLng(defaultlat,defaultlng),map.setCenter(f);var f=map.getCenter();jQuery("#width").val("600"),jQuery("#height").val("400"),map.setLevel(map_zoom)}var g=new daum.maps.ZoomControl;map.addControl(g,daum.maps.ControlPosition.LEFT);var h=new daum.maps.MapTypeControl;map.addControl(h,daum.maps.ControlPosition.TOPRIGHT),daum.maps.event.addListener(map,"dblclick",function(a){latlng=a.latLng,addMarker(latlng)})}function addMarker(a){var b;if("undefined"!=typeof map_markers)for(var c=0;c<map_markers.length;c++)map_markers[c].setMap(null);if(0!=a){var d=a.getLat(),e=a.getLng();map_marker_positions=map_marker_positions.replace(d+","+e+";",""),map_marker_positions+=d+","+e+";"}positions=makeLocationArray(map_marker_positions);for(var c=0;c<positions.length;c++)map_markers[c]=new daum.maps.Marker({position:positions[c]}),map_markers[c].setMap(map),map_markers[c].setDraggable(!0),map_markers[c].soo_position=positions[c],b=map_markers[c],daum.maps.event.addListener(map_markers[c],"dragstart",function(){var a=this.soo_position;map_marker_positions=map_marker_positions.replace(a.getLat()+","+a.getLng()+";","")}),daum.maps.event.addListener(map_markers[c],"dragend",function(){var a=this.getPosition();map_marker_positions=map_marker_positions.replace(a.getLat()+","+a.getLng()+";",""),map_marker_positions+=a.getLat()+","+a.getLng()+";",addMarker(0)}),daum.maps.event.addListener(map_markers[c],"rightclick",function(){var a=this.soo_position;removeMarker(a)});return b}function removeMarker(a){for(var b=0;b<map_markers.length;b++)map_markers[b].setMap(null);var c=a.getLat(),d=a.getLng();map_marker_positions=map_marker_positions.replace(c+","+d+";",""),positions=makeLocationArray(map_marker_positions);for(var b=0;b<positions.length;b++)map_markers[b]=new daum.maps.Marker({position:positions[b]}),map_markers[b].setMap(map),map_markers[b].setDraggable(!0),map_markers[b].soo_position=positions[b],new_marker_obj=map_markers[b],daum.maps.event.addListener(map_markers[b],"dragstart",function(){var a=this.soo_position;map_marker_positions=map_marker_positions.replace(a.getLat()+","+a.getLng()+";","")}),daum.maps.event.addListener(map_markers[b],"dragend",function(){var a=this.getPosition();map_marker_positions=map_marker_positions.replace(a.getLat()+","+a.getLng()+";",""),map_marker_positions+=a.getLat()+","+a.getLng()+";",addMarker(0)}),daum.maps.event.addListener(map_markers[b],"rightclick",function(){var a=this.soo_position;removeMarker(a)})}function makeLocationArray(a){for(var b=new Array,c=a.split(";"),d=0;d<c.length;d++)if(c[d].trim()){var e=c[d].split(",");b[d]=new daum.maps.LatLng(e[0],e[1])}return b}function makeLocationStr(a){for(var b="",c=0;c<a.length;c++)b+=a[c].getLat()+","+a[c].getLng()+";";return b}function insertMap(){if("undefined"!=typeof opener&&opener){var a=jQuery("#width").val(),b=jQuery("#height").val();map_zoom=20-map.getLevel(),map_lat=map.getCenter().getLat(),map_lng=map.getCenter().getLng(),a||(a="600"),b||(b="400");var c={component:"map_components",method:"encode_data",map_center:map_lat+","+map_lng,width:a,height:b,map_markers:map_marker_positions,map_zoom:map_zoom},d="",e=new Array("error","message","results");exec_xml("editor","procEditorCall",c,function(c){var e=c.results;d=e;for(var f='<img src="https://maps-api-ssl.google.com/maps/api/staticmap?center='+map_lat+","+map_lng+"&zoom="+map_zoom+"&size="+a+"x"+b,g=map_marker_positions.split(";"),h=0;h<g.length;h++)g[h].trim()&&(f+="&markers=size:mid|"+g[h]);f+='&sensor=false" editor_component="map_components" alt="'+d+'" style="border:2px dotted #FF0033; no-repeat center;width: '+a+"px; height: "+b+'px;" />',opener.editorFocus(opener.editorPrevSrl);var i=opener.editorGetIFrame(opener.editorPrevSrl);opener.editorReplaceHTML(i,f),opener.editorFocus(opener.editorPrevSrl),window.close()},e)}}var map_zoom=5,map_lat="",map_lng="",map="",marker="",map_markers=new Array,map_marker_positions="",modi_marker_pos="",saved_location=new Array,result_array=new Array,result_from="";jQuery(document).ready(function(){getMaps()});